<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>嫡系计算器2.0</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3b82f6',
            secondary: '#10b981',
            accent: '#8b5cf6',
            neutral: '#1f2937',
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        }
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .btn-primary {@apply bg-primary text-white font-medium py-3 px-6 rounded-lg shadow-md hover:bg-primary/90 transition-all duration-300;}
      .option-card {@apply border rounded-xl p-4 cursor-pointer transition-all duration-200 bg-white hover:shadow-md;}
      .option-card.selected {@apply border-2 border-primary bg-blue-50;}
      .dimension-card {@apply bg-white border rounded-xl p-5 shadow-sm;}
      .social-btn {@apply w-full text-white text-sm font-medium py-2 px-4 rounded-lg shadow hover:opacity-90 transition;}
      .chart-container {@apply relative w-full overflow-hidden;}
      .qrcode-pair {@apply flex flex-col sm:flex-row justify-center items-center gap-6;}
      .qrcode-item {@apply text-center;}
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 font-sans text-neutral">
  <!-- 测试页面 -->
  <div id="quiz-page" class="min-h-screen p-4">
    <!-- 顶部社交链接（仅测试页显示） -->
    <div class="flex flex-col items-center space-y-2 p-4">
      <a href="https://github.com/dachangzhishiku/dachangzhishiku.github.io" target="_blank" class="social-btn bg-blue-500">
        ⭐ 如果觉得还不错，欢迎来 GitHub 点亮星星
      </a>
      <a href="https://www.xiaohongshu.com/user/profile/660ea153000000000600c7ba" target="_blank" class="social-btn bg-red-500">
        ❤️ 欢迎关注我的小红书，持续更新职场实用干货
      </a>
    </div>

    <div class="text-center max-w-md mx-auto mb-6">
      <h1 class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary to-accent mb-4">嫡系计算器2.0</h1>
      <p class="text-gray-600">通过9个维度测试，评估你在组织中的嫡系程度</p>
    </div>
    <div class="max-w-2xl mx-auto">
      <div class="mb-6">
        <div class="flex justify-between text-sm text-gray-500 mb-2">
          <span>已完成 <span id="completed-count">0</span>/9 题</span>
          <span id="progress-text">0%</span>
        </div>
        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
          <div id="progress-bar" class="h-full bg-primary transition-all duration-500 ease-out" style="width:0%"></div>
        </div>
      </div>
      <h2 class="text-xl font-bold mb-6 text-center">请回答以下所有问题</h2>
      <div id="questions-container" class="space-y-4 mb-8"></div>
      <div class="flex justify-center">
        <button id="submit-btn" class="btn-primary" disabled="">提交答案</button>
      </div>
    </div>
  </div>

  <!-- 结果页面 -->
  <div id="result-page" class="min-h-screen p-4 hidden flex flex-col items-center">
    <div class="max-w-4xl w-full space-y-6">
      <!-- 综合得分 -->
      <div class="bg-white rounded-2xl shadow-md p-5 text-center" id="score-card">
        <h2 class="text-xl font-bold mb-3">综合得分</h2>
        <div id="score-text" class="text-4xl font-extrabold text-primary mb-3"></div>
        <div id="level-text" class="text-base font-medium text-gray-600 mb-3"></div>
        <div class="text-left text-xs text-gray-500 border-t pt-3 mt-3">
          <h3 class="font-semibold mb-2">嫡系等级判定说明</h3>
          <table class="w-full border-collapse text-xs">
            <tbody>
              <tr class="bg-gray-100">
                <th class="p-2 border">总分范围</th>
                <th class="p-2 border">嫡系等级</th>
                <th class="p-2 border">职场特征</th>
              </tr>
              <tr>
                <td class="p-2 border">&gt;60</td>
                <td class="p-2 border">心腹嫡系</td>
                <td class="p-2 border">参与重大决策，掌握核心资源</td>
              </tr>
              <tr>
                <td class="p-2 border">50-60</td>
                <td class="p-2 border">核心圈层</td>
                <td class="p-2 border">负责关键业务，资源优先配置</td>
              </tr>
              <tr>
                <td class="p-2 border">40-50</td>
                <td class="p-2 border">外围人员</td>
                <td class="p-2 border">常规工作关系，无特殊关照</td>
              </tr>
              <tr>
                <td class="p-2 border">&lt;40</td>
                <td class="p-2 border">风险人员</td>
                <td class="p-2 border">可能被边缘化或优化</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- 雷达图 - 调整了位置使其与标题中线对齐 -->
      <div class="bg-white rounded-2xl shadow-md p-5" id="radar-card">
        <h3 class="text-lg font-bold mb-3 text-center">维度雷达图</h3>
        <div class="flex justify-center">
          <!-- 增加了ml-2使图表向右移动，与标题中线对齐 -->
          <div class="chart-container ml-2" style="height: 300px; max-width: 400px;">
            <canvas id="radarChart"></canvas>
          </div>
        </div>
      </div>

      <!-- 维度详情 -->
      <div class="bg-white rounded-2xl shadow-md p-5">
        <h3 class="text-lg font-bold mb-4 text-center">维度详情</h3>
        <div id="dimensions-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
      </div>

      <!-- 操作按钮 -->
      <div class="text-center flex flex-col sm:flex-row justify-center gap-3">
        <button id="share-result-btn" class="btn-primary bg-blue-600 hover:bg-blue-700"><i class="fa fa-share-alt mr-2"></i>分享计算器</button>
        <button id="download-screenshot" class="btn-primary bg-green-600 hover:bg-green-700"><i class="fa fa-download mr-2"></i>下载图片</button>
        <button id="back-btn" class="btn-primary bg-gray-600 hover:bg-gray-700"><i class="fa fa-arrow-left mr-2"></i>返回</button>
      </div>

      <!-- 底部两个并排二维码（result-page内部） -->
      <div class="max-w-3xl mx-auto text-center mt-6 p-6 bg-white rounded-2xl shadow-md" id="qrcode-container">
        <div class="qrcode-pair">
          <!-- 第一个二维码 -->
          <div class="qrcode-item">
            <p class="text-gray-700 mb-3 text-sm font-medium">建了个群聊，每周掉落职场干货，欢迎进群~</p>
            <p class="text-sm text-gray-600 mb-2">微信群二维码</p>
            <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/code_assistant/ffd08ae069d84e3cb7a2f7292a181a0a~tplv-a9rns2rl98-image.image?rcl=2025082216491508D12C99CF60573B10A5&amp;rk3s=8e244e95&amp;rrcfp=e75484ac&amp;x-expires=1756457356&amp;x-signature=hLch6F3Pyzdij9nCvHpqfD6cFno%3D" alt="微信群二维码" class="w-40 h-40 rounded-lg shadow border p-2 bg-white">
          </div>
          
          <!-- 第二个二维码 -->
          <div class="qrcode-item">
            <p class="text-gray-700 mb-3 text-sm font-medium">快来测一测你的嫡系指数吧</p>
            <p class="text-sm text-gray-600 mb-2">测试二维码</p>
            <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/code_assistant/6704675a2c9a4abb9d0f1bc0936a12b3~tplv-a9rns2rl98-image.image?rcl=202508221653301E3287D5F693A9DAF498&amp;rk3s=8e244e95&amp;rrcfp=e75484ac&amp;x-expires=1756457610&amp;x-signature=50JWZC9WMaFsKhb1tmaFht%2F9J1I%3D" alt="测试二维码" class="w-40 h-40 rounded-lg shadow border p-2 bg-gray-50 flex items-center justify-center">
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let radarChartInstance = null;

    const questions = [
      { 
        text: "组织关系", 
        dimension: "组织关系", 
        options: [
          {text:"跨三级汇报", score:20, analysis: "层级距离远，信息传递衰减。", suggestion: "主动建立跨级沟通渠道。"},
          {text:"跨两级汇报", score:40, analysis: "存在层级隔阂，影响力有限。", suggestion: "争取更多向上展示的机会。"},
          {text:"直接汇报", score:60, analysis: "常规汇报关系，沟通顺畅。", suggestion: "提升汇报质量，建立信任。"},
          {text:"直接汇报+同部门≥3年", score:80, analysis: "长期合作，有一定信任基础。", suggestion: "深化业务绑定，成为可靠助手。"},
          {text:"领导前嫡系团队", score:100, analysis: "深度绑定，高度信任。", suggestion: "维护长期信任，成为左膀右臂。"}
        ]
      },
      { 
        text: "信任等级", 
        dimension: "信任等级", 
        options: [
          {text:"仅工作沟通", score:20, analysis: "纯工作关系，无额外信任。", suggestion: "增加工作外互动，建立好感。"},
          {text:"参与常规会议", score:40, analysis: "基础信任，纳入常规信息圈。", suggestion: "会议中积极贡献，展现价值。"},
          {text:"参加领导小范围会议", score:60, analysis: "中度信任，进入核心信息圈。", suggestion: "保守机密，提升判断力。"},
          {text:"处理领导私人事务", score:80, analysis: "高度信任，超越工作关系。", suggestion: "把握分寸，公私分明。"},
          {text:"掌握领导核心资源", score:100, analysis: "绝对信任，成为核心心腹。", suggestion: "忠诚可靠，保守核心秘密。"}
        ]
      },
      { 
        text: "项目权重", 
        dimension: "项目权重", 
        options: [
          {text:"支持性工作", score:20, analysis: "参与度低，影响力有限。", suggestion: "主动承担更多责任，展现能力。"},
          {text:"独立模块负责人", score:40, analysis: "有一定职责，但非核心。", suggestion: "做出亮点，争取更大范围负责。"},
          {text:"核心项目骨干", score:60, analysis: "承担重要工作，受重视。", suggestion: "打造核心竞争力，成为不可或缺的角色。"},
          {text:"战略项目负责人", score:80, analysis: "负责关键项目，有战略价值。", suggestion: "确保项目成功，提升战略影响力。"},
          {text:"领导亲自指派项目", score:100, analysis: "深度信任，承担特殊使命。", suggestion: "超额完成，巩固信任基础。"}
        ]
      },
      { 
        text: "晋升轨迹", 
        dimension: "晋升轨迹", 
        options: [
          {text:"无晋升", score:0, analysis: "发展停滞，需警惕。", suggestion: "寻找问题根源，主动寻求突破。"},
          {text:"正常晋升", score:20, analysis: "按部就班，符合预期。", suggestion: "提升差异化优势，争取加速发展。"},
          {text:"破格晋升", score:40, analysis: "表现突出，获得认可。", suggestion: "保持势头，证明晋升合理性。"},
          {text:"跟随领导调岗晋升", score:80, analysis: "受领导器重，同步发展。", suggestion: "适应新环境，快速创造价值。"},
          {text:"领导特批职级", score:100, analysis: "高度认可，特殊对待。", suggestion: "匹配职级要求，不负所托。"}
        ]
      },
      { 
        text: "资源倾斜", 
        dimension: "资源倾斜", 
        options: [
          {text:"资源受限", score:25, analysis: "获取资源较少。", suggestion: "学会用有限资源做出成果。"},
          {text:"标准配置", score:50, analysis: "处于正常水平。", suggestion: "逐渐申请更多资源。"},
          {text:"优先获取资源", score:75, analysis: "具备较高优先级。", suggestion: "确保成果回报资源支持。"},
          {text:"领导特批资源", score:100, analysis: "获得特殊照顾。", suggestion: "谨慎使用，避免口碑风险。"}
        ]
      },
      { 
        text: "信息权限", 
        dimension: "信息权限", 
        options: [
          {text:"信息滞后", score:25, analysis: "处于信息末端。", suggestion: "主动拓展信息渠道。"},
          {text:"同步知悉", score:50, analysis: "获取信息及时。", suggestion: "保证理解和执行。"},
          {text:"提前获知未公开信息", score:75, analysis: "提前获知，说明被信任。", suggestion: "注意保密。"},
          {text:"参与决策讨论", score:100, analysis: "直接参与核心决策。", suggestion: "发挥战略思考力。"}
        ]
      },
      { 
        text: "危机处理", 
        dimension: "危机处理", 
        options: [
          {text:"被牺牲", score:25, analysis: "处于弱势，风险高。", suggestion: "增强不可替代性。"},
          {text:"中立状态", score:50, analysis: "保持中性，安全但边缘。", suggestion: "寻找提升存在感的机会。"},
          {text:"领导公开维护", score:75, analysis: "获得一定保护。", suggestion: "维持与领导良好关系。"},
          {text:"领导私下保护", score:100, analysis: "深度信任，关键时刻被优先照顾。", suggestion: "继续巩固，保持低调。"}
        ]
      },
      { 
        text: "绩效情况", 
        dimension: "绩效情况", 
        options: [
          {text:"长期低绩效/背锅侠（C/D）", score:20, analysis: "处于边缘或风险。", suggestion: "寻找短期可提升的突破口。"},
          {text:"近期绩效下滑（S/A→B/C）", score:40, analysis: "状态不稳定。", suggestion: "分析原因并快速调整。"},
          {text:"稳定中等（近2次B+/B）", score:60, analysis: "处于稳定区间。", suggestion: "适当寻找亮点项目突破。"},
          {text:"近期绩效提升（近2次B+/B）", score:80, analysis: "状态上升。", suggestion: "持续保持，扩大影响力。"},
          {text:"持续高绩效（近2次S/A）", score:100, analysis: "核心绩效背书。", suggestion: "保持长期稳定，关注团队贡献。"}
        ]
      },
      { 
        text: "RSU/股权激励授予", 
        dimension: "股权激励", 
        options: [
          {text:"从未获得过任何激励", score:20, analysis: "不在激励核心。", suggestion: "提升稀缺价值，争取关注。"},
          {text:"仅入职授予，后续无新增", score:40, analysis: "缺乏持续性认可。", suggestion: "保持业绩，争取新激励。"},
          {text:"授予价值低于同级", score:60, analysis: "认可度有限。", suggestion: "对比同级，提出合理诉求。"},
          {text:"授予价值高于同级", score:80, analysis: "价值较高。", suggestion: "继续提升，保持核心地位。"},
          {text:"授予周期稳定且价值可观", score:100, analysis: "处于激励核心。", suggestion: "稳定发挥，避免波动。"}
        ]
      }
    ];

    // 渲染题目
    function renderAllQuestions(){
      const c=document.getElementById("questions-container");
      c.innerHTML="";
      
      questions.forEach((q,i)=>{
        let opts="";
        q.options.forEach((opt,j)=>{
          opts+=`<div class="option-card" data-q="${i}" data-index="${j}">${opt.text}</div>`;
        });
        c.innerHTML+=`<div class="bg-white rounded-xl shadow p-4">
          <h3 class="font-semibold mb-3">${i+1}. ${q.text}</h3>
          <div class="space-y-2">${opts}</div>
        </div>`;
      });
    }

    function updateProgress(){
      const total=questions.length;
      const answered=document.querySelectorAll('.option-card.selected').length;
      document.getElementById('completed-count').innerText=answered;
      const percent=Math.round(answered/total*100);
      document.getElementById('progress-text').innerText=percent+"%";
      document.getElementById('progress-bar').style.width=percent+"%";
      document.getElementById('submit-btn').disabled=answered<total;
    }

    function calculateResult(){
      let results=[];
      let sum=0;
      
      questions.forEach((q,i)=>{
        const sel=document.querySelector(`.option-card.selected[data-q="${i}"]`);
        if(sel){
          const opt=q.options[parseInt(sel.dataset.index)];
          results.push({...opt,dimension:q.dimension});
          sum+=opt.score;
        }
      });
      
      const avg=sum/questions.length;
      showResult(results,avg);
    }

    function getLevel(score){
      if(score>60)return"心腹嫡系：参与重大决策，掌握核心资源";
      if(score>=50)return"核心圈层：负责关键业务，资源优先配置";
      if(score>=40)return"外围人员：常规关系，无特殊关照";
      return"风险人员：可能被边缘化或优化";
    }

    function showResult(dim,avg){
      document.getElementById('quiz-page').classList.add('hidden');
      document.getElementById('result-page').classList.remove('hidden');
      document.getElementById('score-text').innerText=avg.toFixed(1);
      document.getElementById('level-text').innerText=getLevel(avg);

      // 绘制雷达图
      const ctx=document.getElementById('radarChart');
      if(radarChartInstance)radarChartInstance.destroy();
      radarChartInstance=new Chart(ctx,{
        type:'radar',
        data:{
          labels:dim.map(d=>d.dimension),
          datasets:[{
            label:'得分',
            data:dim.map(d=>d.score),
            backgroundColor:'rgba(59,130,246,0.2)',
            borderColor:'#3b82f6',
            pointBackgroundColor:'#3b82f6'
          }]
        },
        options:{
          scales:{
            r:{
              min:0,
              max:100
            }
          }
        }
      });

      // 渲染维度详情
      const dc=document.getElementById('dimensions-container');
      dc.innerHTML="";
      
      dim.forEach(d=>{
        dc.innerHTML+=`<div class="dimension-card">
          <div class="flex justify-between">
            <h4>${d.dimension}</h4>
            <span>${d.score}分</span>
          </div>
          <div class="text-sm text-gray-600">${d.analysis}</div>
          <div class="text-sm text-green-600">
            <i class="fa fa-lightbulb-o"></i> ${d.suggestion}
          </div>
        </div>`;
      });
    }

    document.addEventListener("DOMContentLoaded",()=>{
      renderAllQuestions();

      // 选项点击事件
      document.addEventListener("click",e=>{
        if(e.target.classList.contains("option-card")){
          const q=e.target.dataset.q;
          document.querySelectorAll(`.option-card[data-q="${q}"]`).forEach(el=>{
            el.classList.remove("selected");
          });
          e.target.classList.add("selected");
          updateProgress();
        }
      });

      // 提交按钮
      document.getElementById("submit-btn").addEventListener("click",calculateResult);
      
      // 返回按钮
      document.getElementById("back-btn").addEventListener("click",()=>{
        document.getElementById("result-page").classList.add("hidden");
        document.getElementById("quiz-page").classList.remove("hidden");
        renderAllQuestions();
        updateProgress();
      });

      // 分享按钮功能 - 修复版
      document.getElementById("share-result-btn").addEventListener("click",()=>{
        const url = "https://dachangzhishiku.github.io/";
        const button = document.getElementById("share-result-btn");
        const originalText = button.innerHTML;
        
        // 尝试复制到剪贴板
        navigator.clipboard.writeText(url).then(() => {
          // 复制成功，更新按钮文本
          button.innerHTML = '<i class="fa fa-check mr-2"></i>网址已复制，去分享吧';
          
          // 2秒后恢复原文本
          setTimeout(() => {
            button.innerHTML = originalText;
          }, 2000);
        }).catch(err => {
          // 复制失败，显示错误信息
          console.error('无法复制文本: ', err);
          alert('复制失败，请手动复制网址：' + url);
        });
      });

      // 下载图片功能
      document.getElementById("download-screenshot").addEventListener("click",()=>{
        const resultPage = document.getElementById("result-page");
        
        setTimeout(() => {
          html2canvas(resultPage, {
            scale: 2,
            useCORS: true,
            logging: false,
            height: resultPage.scrollHeight,
            width: resultPage.scrollWidth,
            windowWidth: resultPage.scrollWidth,
            windowHeight: resultPage.scrollHeight
          }).then(canvas => {
            const a = document.createElement("a");
            a.href = canvas.toDataURL("image/png");
            a.download = "嫡系指数测试结果.png";
            a.click();
          }).catch(err => {
            console.error('截图失败: ', err);
            alert("截图失败，请重试");
          });
        }, 1000);
      });
    });
  </script>
</body>
</html>
