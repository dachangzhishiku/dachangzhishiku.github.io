<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>嫡系计算器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <!-- 截图库 -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <!-- 配置Tailwind自定义颜色和字体 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#10b981',
                        accent: '#8b5cf6',
                        neutral: '#1f2937',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-hover {
                transition: all 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            }
            .btn-primary {
                @apply bg-primary text-white font-medium py-3 px-6 rounded-lg shadow-md hover:bg-primary/90 transition-all duration-300 transform hover:scale-105;
            }
            .btn-secondary {
                @apply bg-white text-neutral font-medium py-3 px-6 rounded-lg shadow-md border border-gray-200 hover:bg-gray-50 transition-all duration-300 transform hover:scale-105;
            }
            .btn-accent {
                @apply bg-accent text-white font-medium py-3 px-6 rounded-lg shadow-md hover:bg-accent/90 transition-all duration-300 transform hover:scale-105;
            }
            .toast {
                @apply fixed bottom-8 left-1/2 transform -translate-x-1/2 bg-neutral text-white px-6 py-3 rounded-full shadow-lg z-50 opacity-0 transition-opacity duration-300;
            }
            .toast.show {
                @apply opacity-100;
            }
            /* 分享弹窗样式 */
            .share-modal {
                @apply fixed inset-0 bg-black/70 z-50 flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300;
            }
            .share-modal.show {
                @apply opacity-100 pointer-events-auto;
            }
            .share-content {
                @apply bg-white rounded-2xl shadow-2xl p-6 max-w-md w-full mx-4 transform scale-95 transition-transform duration-300;
            }
            .share-modal.show .share-content {
                @apply scale-100;
            }
            .screenshot-container {
                @apply border border-gray-200 rounded-xl overflow-hidden mb-4;
            }
            .screenshots-wrapper {
                @apply space-y-4 mb-6;
            }
            /* 居中截图容器 */
            .centered-screenshot {
                @apply flex justify-center items-center p-4 bg-gray-50;
            }
            /* 表格样式 */
            .rating-table {
                @apply w-full border-collapse text-sm;
            }
            .rating-table th {
                @apply bg-gray-50 py-2 px-3 text-left border border-gray-200 font-semibold;
            }
            .rating-table td {
                @apply py-2 px-3 border border-gray-200;
            }
            /* 得分区域容器 - 确保椭圆框内上下居中 */
            .score-container {
                @apply flex flex-col items-center justify-center min-h-[200px] w-full;
            }
            /* 雷达图容器 - 确保在白色框内居中 */
            .radar-container {
                @apply flex justify-center items-center w-full h-full p-2;
            }
            /* 椭圆标签样式 - 确保内部文字上下居中 */
            .score-badge {
                @apply inline-flex items-center justify-center px-4 py-1.5 rounded-full bg-blue-100 text-primary text-sm font-medium mb-3;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen font-sans text-neutral">
    <!-- 提示框 -->
    <div id="toast" class="toast">提示信息</div>
    
    <!-- 分享结果弹窗 -->
    <div id="share-modal" class="share-modal">
        <div class="share-content">
            <h3 class="text-xl font-bold mb-4 text-center">分享你的测试结果</h3>
            <p class="text-gray-500 text-sm text-center mb-4">截图分享给好友</p>
            
            <!-- 分别显示得分和雷达图的截图（添加居中样式） -->
            <div class="screenshots-wrapper">
                <div class="screenshot-container centered-screenshot">
                    <img id="score-screenshot" src="" alt="得分信息截图" class="max-w-full max-h-[200px]">
                </div>
                <div class="screenshot-container centered-screenshot">
                    <img id="radar-screenshot" src="" alt="雷达图截图" class="max-w-full max-h-[200px]">
                </div>
            </div>
            
            <!-- 预留二维码位置 - 已替换为新的短链二维码 -->
            <div class="flex justify-center mb-6">
                <div id="qrcode-container" class="w-32 h-32 border border-dashed border-gray-300 rounded-lg flex items-center justify-center bg-gray-50">
                    <img id="custom-qrcode" src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/code_assistant/8bfff67ce267432fb7fb2a4a9694038e~tplv-a9rns2rl98-image.image?rk3s=8e244e95&amp;rrcfp=e75484ac&amp;x-expires=1754622182&amp;x-signature=eACpRI%2FEEHxqZpKb9DmgI%2BCwgxU%3D" alt="分享二维码" class="w-full h-full object-contain p-2">
                </div>
            </div>
            
            <p class="text-gray-400 text-xs text-center mb-4">扫码测测自己的得分</p>
            
            <button id="close-share-modal" class="btn-primary w-full">
                关闭
            </button>
        </div>
    </div>
    
    <!-- 首页 -->
    <div id="home-page" class="min-h-screen flex flex-col items-center justify-center p-6">
        <div class="text-center max-w-md mx-auto">
            <h1 class="text-[clamp(2.5rem,8vw,4rem)] font-bold text-transparent bg-clip-text bg-gradient-to-r from-primary to-accent mb-6 leading-tight text-shadow">
               嫡系计算器
            </h1>
            <p class="text-gray-600 text-lg mb-10">
                通过7个维度测试，评估你在组织中的嫡系程度
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button id="start-btn" class="btn-primary flex items-center justify-center gap-2">
                    <i class="fa fa-play-circle"></i> 开始测试
                </button>
                <button id="share-btn" class="btn-secondary flex items-center justify-center gap-2">
                    <i class="fa fa-share-alt"></i> 分享计算器
                </button>
            </div>
        </div>
    </div>
    
    <!-- 测试页面 -->
    <div id="quiz-page" class="min-h-screen p-6 hidden">
        <div class="max-w-2xl mx-auto">
            <!-- 进度条 -->
            <div class="mb-8">
                <div class="flex justify-between text-sm text-gray-500 mb-2">
                    <span>问题 <span id="current-question">1</span>/7</span>
                    <span id="progress-text">14%</span>
                </div>
                <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-primary transition-all duration-500 ease-out" style="width: 14%"></div>
                </div>
            </div>
            
            <!-- 题目卡片 -->
            <div class="bg-white rounded-2xl shadow-xl p-6 mb-8 transform transition-all duration-500">
                <h2 id="question-text" class="text-2xl font-bold mb-6 text-neutral">组织关系</h2>
                
                <div id="options-container" class="space-y-3">
                    <!-- 选项将通过JS动态生成 -->
                </div>
            </div>
            
            <!-- 导航按钮 -->
            <div class="flex justify-between">
                <button id="prev-btn" class="btn-secondary hidden" disabled="">
                    <i class="fa fa-arrow-left mr-2"></i> 上一题
                </button>
                <div class="ml-auto">
                    <button id="next-btn" class="btn-primary">
                        下一题 <i class="fa fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 结果页面 -->
    <div id="result-page" class="min-h-screen p-6 hidden">
        <div class="max-w-3xl mx-auto">
            <h2 class="text-3xl font-bold text-center mb-2">测试结果</h2>
            <p class="text-gray-500 text-center mb-8">你的职场嫡系指数分析</p>
            
            <!-- 结果卡片 -->
            <div id="result-card" class="bg-white rounded-2xl shadow-xl p-6 mb-8">
                <!-- 综合得分和雷达图 -->
                <div class="flex flex-col md:flex-row items-center gap-8 mb-8">
                    <!-- 得分信息 - 确保综合评分在椭圆框内上下居中 -->
                    <div id="score-section" class="text-center md:text-left flex-1">
                        <div class="score-container">
                            <div class="score-badge">
                                综合评分
                            </div>
                            <h3 class="text-5xl font-bold text-neutral mb-2" id="total-score">0</h3>
                            <h4 class="text-2xl font-semibold mb-4 text-accent" id="dixi-level">评估中...</h4>
                            <p class="text-gray-600" id="level-description">请完成测试查看结果</p>
                        </div>
                    </div>
                    
                    <!-- 雷达图 - 确保在白色框内居中 -->
                    <div id="radar-section" class="w-full md:w-64 h-64 flex-1">
                        <div class="radar-container">
                            <canvas id="radar-chart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- 嫡系等级判定说明 -->
                <div class="mt-6 border-t pt-6">
                    <h5 class="text-lg font-semibold mb-3 text-neutral">嫡系等级判定说明</h5>
                    <table class="rating-table">
                        <thead>
                            <tr>
                                <th>总分范围</th>
                                <th>嫡系等级</th>
                                <th>职场特征</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>&gt;60分</td>
                                <td>心腹嫡系</td>
                                <td>参与重大决策，掌握核心资源，领导心腹</td>
                            </tr>
                            <tr>
                                <td>50-60分</td>
                                <td>核心圈层</td>
                                <td>负责关键业务，资源优先配置，领导核心圈层</td>
                            </tr>
                            <tr>
                                <td>40-50分</td>
                                <td>外围人员</td>
                                <td>常规工作关系，无特殊关照</td>
                            </tr>
                            <tr>
                                <td>&lt;40分</td>
                                <td>风险人员</td>
                                <td>可能被边缘化或优化</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- 行动按钮 -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center mb-10">
                <button id="restart-btn" class="btn-primary flex items-center justify-center gap-2">
                    <i class="fa fa-refresh"></i> 重新测试
                </button>
                <button id="share-result-btn" class="btn-accent flex items-center justify-center gap-2">
                    <i class="fa fa-share-square-o"></i> 分享结果
                </button>
                <button id="share-calculator-btn" class="btn-secondary flex items-center justify-center gap-2">
                    <i class="fa fa-share-alt"></i> 分享计算器
                </button>
            </div>
            
            <div class="text-center mb-8">
                <p class="text-gray-600 text-sm mb-4">大厂知识库，致力于突破大厂信息茧房，持续分享职场干货，欢迎进群~</p>
                <div class="bg-white p-4 rounded-xl shadow-md inline-block">
                    <!-- 已替换为新的短链二维码 -->
                    <img src="https://p9-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/code_assistant/c59f40ea003c49ed9727e382fca30e29~tplv-a9rns2rl98-image.image?rk3s=8e244e95&amp;rrcfp=e75484ac&amp;x-expires=1754622134&amp;x-signature=yhei%2FTaZsVByiRZJbBl128sHY9E%3D" alt="分享二维码" class="w-64 h-64 object-cover rounded-lg">
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // 题目数据
        const questions = [
            {
                id: 1,
                title: "组织关系",
                dimension: "组织关系",
                options: [
                    { text: "跨三级汇报", score: 20 },
                    { text: "跨两级汇报", score: 40 },
                    { text: "直接汇报", score: 60 },
                    { text: "直接汇报+同部门≥3年", score: 80 },
                    { text: "领导前嫡系团队", score: 100 }
                ]
            },
            {
                id: 2,
                title: "信任等级",
                dimension: "信任等级",
                options: [
                    { text: "仅工作沟通", score: 20 },
                    { text: "参与常规会议", score: 40 },
                    { text: "参加领导小范围会议", score: 60 },
                    { text: "处理领导私人事务", score: 80 },
                    { text: "掌握领导核心资源", score: 100 }
                ]
            },
            {
                id: 3,
                title: "项目权重",
                dimension: "项目权重",
                options: [
                    { text: "支持性工作", score: 20 },
                    { text: "独立模块负责人", score: 40 },
                    { text: "核心项目骨干", score: 60 },
                    { text: "战略项目负责人", score: 80 },
                    { text: "领导亲自指派项目", score: 100 }
                ]
            },
            {
                id: 4,
                title: "晋升轨迹",
                dimension: "晋升轨迹",
                options: [
                    { text: "无晋升", score: 20 },
                    { text: "正常晋升", score: 40 },
                    { text: "破格晋升", score: 60 },
                    { text: "跟随领导调岗晋升", score: 80 },
                    { text: "领导特批职级", score: 100 }
                ]
            },
            {
                id: 5,
                title: "资源倾斜",
                dimension: "资源倾斜",
                options: [
                    { text: "资源受限", score: 25 },
                    { text: "标准配置", score: 50 },
                    { text: "优先获取资源", score: 75 },
                    { text: "领导特批资源", score: 100 }
                ]
            },
            {
                id: 6,
                title: "信息权限",
                dimension: "信息权限",
                options: [
                    { text: "信息滞后", score: 25 },
                    { text: "同步知悉", score: 50 },
                    { text: "提前获知未公开信息", score: 75 },
                    { text: "参与决策讨论", score: 100 }
                ]
            },
            {
                id: 7,
                title: "危机处理",
                dimension: "危机处理",
                options: [
                    { text: "被牺牲", score: 25 },
                    { text: "中立状态", score: 50 },
                    { text: "领导公开维护", score: 75 },
                    { text: "领导私下保护", score: 100 }
                ]
            }
        ];
        
        // 等级评定标准
        const levels = [
            { min: 60, max: 100, level: "心腹嫡系", description: "参与重大决策，掌握核心资源，领导心腹" },
            { min: 50, max: 60, level: "核心圈层", description: "负责关键业务，资源优先配置，领导核心圈层" },
            { min: 40, max: 50, level: "外围人员", description: "常规工作关系，无特殊关照" },
            { min: 0, max: 40, level: "风险人员", description: "可能被边缘化或优化" }
        ];
        
        // 全局变量
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let radarChart = null;
        const shareUrl = "https://wyws.bmwca.cn/q8xcQz"; // 更新为新的短链
        
        // DOM元素
        const homePage = document.getElementById('home-page');
        const quizPage = document.getElementById('quiz-page');
        const resultPage = document.getElementById('result-page');
        const startBtn = document.getElementById('start-btn');
        const shareBtn = document.getElementById('share-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');
        const shareResultBtn = document.getElementById('share-result-btn');
        const shareCalculatorBtn = document.getElementById('share-calculator-btn');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const currentQuestionEl = document.getElementById('current-question');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const totalScoreEl = document.getElementById('total-score');
        const dixiLevelEl = document.getElementById('dixi-level');
        const levelDescriptionEl = document.getElementById('level-description');
        const toastEl = document.getElementById('toast');
        const shareModal = document.getElementById('share-modal');
        const closeShareModal = document.getElementById('close-share-modal');
        const scoreScreenshot = document.getElementById('score-screenshot');
        const radarScreenshot = document.getElementById('radar-screenshot');
        const qrcodeContainer = document.getElementById('qrcode-container');
        const customQrcode = document.getElementById('custom-qrcode');
        const scoreSection = document.getElementById('score-section');
        const radarSection = document.getElementById('radar-section');
        
        // 初始化事件监听
        function initEventListeners() {
            startBtn.addEventListener('click', goToQuiz);
            shareBtn.addEventListener('click', shareApp);
            prevBtn.addEventListener('click', goToPrevQuestion);
            nextBtn.addEventListener('click', goToNextQuestion);
            restartBtn.addEventListener('click', restartQuiz);
            shareResultBtn.addEventListener('click', shareResult);
            shareCalculatorBtn.addEventListener('click', shareCalculator);
            closeShareModal.addEventListener('click', () => {
                shareModal.classList.remove('show');
            });
        }
        
        // 显示提示信息
        function showToast(message) {
            toastEl.textContent = message;
            toastEl.classList.add('show');
            
            setTimeout(() => {
                toastEl.classList.remove('show');
            }, 3000);
        }
        
        // 页面切换
        function fadeOut(element, callback) {
            element.style.opacity = '0';
            setTimeout(() => {
                element.classList.add('hidden');
                if (callback) callback();
            }, 300);
        }
        
        function fadeIn(element) {
            element.classList.remove('hidden');
            setTimeout(() => {
                element.style.opacity = '1';
            }, 50);
        }
        
        // 前往测试页面
        function goToQuiz() {
            fadeOut(homePage, () => {
                fadeIn(quizPage);
                loadQuestion(currentQuestionIndex);
            });
        }
        
        // 返回首页
        function goToHome() {
            fadeOut(resultPage, () => {
                fadeIn(homePage);
            });
        }
        
        // 加载问题
        function loadQuestion(index) {
            const question = questions[index];
            questionText.textContent = question.title;
            currentQuestionEl.textContent = question.id;
            
            // 更新进度
            const progress = ((index + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
            progressText.textContent = `${Math.round(progress)}%`;
            
            // 生成选项
            optionsContainer.innerHTML = '';
            question.options.forEach((option, optIndex) => {
                const optionEl = document.createElement('div');
                optionEl.className = `card-hover border rounded-xl p-4 cursor-pointer ${
                    userAnswers[index] === optIndex ? 'border-primary bg-blue-50' : 'border-gray-200 hover:border-primary/50'
                }`;
                optionEl.innerHTML = `
                    <div class="flex items-center">
                        <div class="w-5 h-5 rounded-full border-2 ${
                            userAnswers[index] === optIndex ? 'border-primary bg-primary' : 'border-gray-300'
                        } flex items-center justify-center mr-3">
                            ${userAnswers[index] === optIndex ? '<i class="fa fa-check text-white text-xs"></i>' : ''}
                        </div>
                        <span>${option.text}</span>
                    </div>
                `;
                
                optionEl.addEventListener('click', () => {
                    userAnswers[index] = optIndex;
                    loadQuestion(index);
                });
                
                optionsContainer.appendChild(optionEl);
            });
            
            // 更新按钮状态
            prevBtn.disabled = index === 0;
            prevBtn.classList.toggle('hidden', index === 0);
            nextBtn.innerHTML = index === questions.length - 1 
                ? '查看结果 <i class="fa fa-arrow-right ml-2"></i>'
                : '下一题 <i class="fa fa-arrow-right ml-2"></i>';
        }
        
        // 上一题
        function goToPrevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            }
        }
        
        // 下一题或提交
        function goToNextQuestion() {
            // 检查是否已选择答案
            if (userAnswers[currentQuestionIndex] === undefined) {
                // 提示用户选择答案
                const card = document.querySelector('.transform');
                card.style.animation = 'shake 0.5s';
                setTimeout(() => {
                    card.style.animation = '';
                }, 500);
                return;
            }
            
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            } else {
                // 计算结果并显示
                calculateResult();
                fadeOut(quizPage, () => {
                    fadeIn(resultPage);
                    renderRadarChart();
                });
            }
        }
        
        // 计算结果
        function calculateResult() {
            let totalScore = 0;
            
            questions.forEach((question, index) => {
                const selectedOption = question.options[userAnswers[index]];
                totalScore += selectedOption.score;
            });
            
            // 计算平均分
            const averageScore = (totalScore / questions.length).toFixed(1);
            totalScoreEl.textContent = averageScore;
            
            // 确定等级
            let levelInfo = levels[3]; // 默认最低等级
            for (const level of levels) {
                if (averageScore > level.min) {
                    levelInfo = level;
                    break;
                }
            }
            
            dixiLevelEl.textContent = levelInfo.level;
            levelDescriptionEl.textContent = levelInfo.description;
            
            // 设置等级颜色
            switch(levelInfo.level) {
                case "心腹嫡系":
                    dixiLevelEl.classList.add('text-green-600');
                    break;
                case "核心圈层":
                    dixiLevelEl.classList.add('text-blue-600');
                    break;
                case "外围人员":
                    dixiLevelEl.classList.add('text-yellow-600');
                    break;
                case "风险人员":
                    dixiLevelEl.classList.add('text-red-600');
                    break;
            }
        }
        
        // 绘制雷达图
        function renderRadarChart() {
            const ctx = document.getElementById('radar-chart').getContext('2d');
            
            // 准备数据
            const labels = questions.map(q => q.dimension);
            const data = questions.map((q, index) => q.options[userAnswers[index]].score);
            
            // 如果已有图表，先销毁
            if (radarChart) {
                radarChart.destroy();
            }
            
            // 创建雷达图
            radarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '你的得分',
                        data: data,
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        pointBackgroundColor: 'rgba(59, 130, 246, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(59, 130, 246, 1)'
                    }]
                },
                options: {
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        // 重新测试
        function restartQuiz() {
            currentQuestionIndex = 0;
            userAnswers = [];
            goToHome();
        }
        
        // 分享计算器 - 首页
        function shareApp() {
            navigator.clipboard.writeText(shareUrl).then(() => {
                showToast('网址已复制到剪贴板，快去粘贴吧');
            }).catch(err => {
                console.error('无法复制内容: ', err);
                // 兼容方案
                const tempInput = document.createElement('input');
                document.body.appendChild(tempInput);
                tempInput.value = shareUrl;
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                showToast('网址已复制到剪贴板，快去粘贴吧');
            });
        }
        
        // 分享计算器 - 结果页
        function shareCalculator() {
            navigator.clipboard.writeText(shareUrl).then(() => {
                showToast('网址已复制到剪贴板，快去粘贴吧');
            }).catch(err => {
                console.error('无法复制内容: ', err);
                // 兼容方案
                const tempInput = document.createElement('input');
                document.body.appendChild(tempInput);
                tempInput.value = shareUrl;
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                showToast('网址已复制到剪贴板，快去粘贴吧');
            });
        }
        
        // 分享结果功能 - 分别截取得分和雷达图
        function shareResult() {
            // 显示加载提示
            showToast('正在准备分享内容...');
            
            // 1. 分别截取得分部分和雷达图部分
            Promise.all([
                html2canvas(scoreSection),
                html2canvas(radarSection)
            ]).then(([scoreCanvas, radarCanvas]) => {
                // 2. 显示截图
                scoreScreenshot.src = scoreCanvas.toDataURL('image/png');
                radarScreenshot.src = radarCanvas.toDataURL('image/png');
                
                // 3. 显示分享弹窗
                setTimeout(() => {
                    shareModal.classList.add('show');
                    showToast('截图已准备好，可分享给好友');
                }, 500);
            }).catch(error => {
                console.error('生成截图失败:', error);
                showToast('生成分享内容失败，请重试');
            });
        }
        
        // 初始化应用
        function initApp() {
            initEventListeners();
        }
        
        // 启动应用
        window.addEventListener('DOMContentLoaded', initApp);
    </script>

    </body></html>
